"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const a=require("react"),D=e=>{if(typeof e=="number")return e;if(typeof e=="string"){const t=Q(e);try{const n=parseFloat(t);return isNaN(n)?0:n}catch{return 0}}else return 0},Q=e=>{let t=0;for(;t<e.length&&V(e[t]);)t++;return e.slice(t)},V=e=>isNaN(parseFloat(e)),h=e=>[...e].sort((t,n)=>{if(typeof t=="number"&&typeof n=="number")return t-n;{if(!isNaN(parseInt(t+""))&&!isNaN(parseInt(n+"")))return parseInt(t+"")-parseInt(n+"");const r=(t+"")[0],i=(n+"")[0];if(r===i){const d=(t+"").slice(1),s=(n+"").slice(1);return!isNaN(parseInt(d))&&!isNaN(parseInt(s))?parseInt(d)-parseInt(s):t<n?-1:t>n?1:0}else return t<n?-1:t>n?1:0}});let _=0,E=1,o;const z=e=>{o===void 0&&(o=I.length);const t=(_+e*E)%o;return I[t]},C=()=>{o===void 0&&(o=I.length),_+=1,o-=1,o<I.length-6&&(o=I.length);let e=!1;for(;!e;)E+=1,F(E,o)&&(e=!0)},F=(e,t)=>{for(let n=2;n<=e;n++)if(e%n===0&&t%n===0)return!1;return!0},I=["#00ff00","#ff00ff","#0080ff","#ff8000","#80bf80","#470ba7","#c80b32","#fd7ee5","#027d30","#00ffff","#00ff80","#9c5a86","#808000","#8ed7fa","#80ff00","#6e52ff","#0000ff","#119c9b","#feb982","#56333d","#fb2b97","#8000ff","#c3f1a2","#b3bd25","#45bc2d","#1c4b88","#49f3c0","#a90c9c","#c436ea","#13055b","#7f93d0","#c4552d","#ee7381","#800000","#58fe60","#4f825e","#21bde8","#d7b8e0","#1e40ee","#324a01","#fc2b03","#723cb9","#3a6ac1","#aef14e","#14c568","#bd9c9b","#f9c506","#b579fa","#810e5e","#b38d4d","#854810","#02ea3a","#0b3b3c","#f90161","#07c304","#fe4c54","#be02ea","#0521bb","#338b05","#4989ff","#52b8b3","#be3271","#f1a441","#0b776b","#0ccfac","#cd61bd","#85fc95","#fe43fe","#bd810d","#cce9e6","#644179","#fedfbe","#80bd00","#99c4bd","#48e5fa","#400626","#bcfc01","#866b3f","#5422e9","#ea03bd","#69809a","#bfca76","#40e60e","#f1da52","#3d5f3b","#63b3f8","#7cd83d","#b52f02","#9364ca","#80a740","#3ce183","#a6a9f6","#fba2bb","#e3763f","#ae3cae","#91414a","#1e94cf","#06f6c9"],u=(e,t)=>{const{targetUnit:n}=t;if(n===void 0)throw Error("UNIQUE_SELECT for unit selection requires a target unit to be set.");return{...e,lastClickedId:n,selectedUnitIds:new Set(e.selectedUnitIds.has(n)?[]:[n]),currentUnitId:n}},q=(e,t)=>{if(e.lastClickedId===void 0)return e.orderedUnitIds.length===0?e:u(e,{type:c,targetUnit:e.orderedUnitIds[0]});const n=e.orderedUnitIds.indexOf(e.lastClickedId);if(n<0)return e;const r=e.orderedUnitIds[n+1];return r===void 0?e:u(e,{type:c,targetUnit:r})},H=(e,t)=>{if(e.lastClickedId===void 0)return e;const n=e.orderedUnitIds.indexOf(e.lastClickedId);if(n<0||n===0)return e;const r=e.orderedUnitIds[n-1];return r===void 0?e:u(e,{type:c,targetUnit:r})},M=(e,t)=>e.orderedUnitIds.length===0?e:u(e,{type:c,targetUnit:e.orderedUnitIds[0]}),$=(e,t)=>e.orderedUnitIds.length===0?e:u(e,{type:c,targetUnit:e.orderedUnitIds[e.orderedUnitIds.length-1]}),K=(e,t)=>({...e,currentUnitId:(t.incomingSelectedUnitIds||[])[0],selectedUnitIds:new Set(t.incomingSelectedUnitIds??[])}),w=e=>e.selectedUnitIds.size===0?"none":e.selectedUnitIds.size===e.orderedUnitIds.length?"all":!e.visibleUnitIds||e.visibleUnitIds.length===0||e.selectedUnitIds.size!==e.visibleUnitIds.length||e.visibleUnitIds.some(t=>!e.selectedUnitIds.has(t))?"partial":"all",b=(e,t)=>{if(t.targetUnit===void 0)throw new Error("Attempt to toggle unit with unset unitid.");const n=new Set([...e.selectedUnitIds]);n.has(t.targetUnit)?n.delete(t.targetUnit):n.add(t.targetUnit);let r=e.currentUnitId;return t.targetUnit===e.currentUnitId&&(r=[...n][0]),[...n].length===1&&(r=[...n][0]),{...e,selectedUnitIds:n,currentUnitId:r,lastClickedId:t.targetUnit}},B=(e,t)=>{const{selectedUnitIds:n,lastClickedId:r,orderedUnitIds:i}=e,{targetUnit:d}=t;if(i.length===0)throw Error("Attempt to toggle range with no units initialized.");if(!r||!d)return console.warn(`Cannot toggle range with undefined limit: last-clicked ${r}, target ${d}`),e;const s=i.findIndex(U=>U===r),l=i.findIndex(U=>U===d);if(s===-1||l===-1)throw Error(`Requested to toggle unit range from ID ${r} to ID ${d} but one of these was not found.`);const T=i.slice(Math.min(s,l),Math.max(s,l)+1);return n.has(d)?T.forEach(U=>n.delete(U)):T.forEach(U=>n.add(U)),e.currentUnitId?n.has(e.currentUnitId)||(e.currentUnitId=[...n][0]):e.currentUnitId=[...n][0],{...e,lastClickedId:d,selectedUnitIds:new Set(n),currentUnitId:e.currentUnitId}},X=e=>{const t=w(e),n=t==="all"||t==="partial"?new Set:new Set(e.orderedUnitIds);return e.currentUnitId?n.has(e.currentUnitId)||(e.currentUnitId=[...n][0]):e.currentUnitId=[...n][0],{...e,selectedUnitIds:n}},N=e=>t=>n=>{Z(t,e,n)},Y=e=>t=>n=>{j(t,e,n)},Z=(e,t,n)=>{const r={type:n.ctrlKey?c:n.shiftKey?g:S,targetUnit:e};t(r)},j=(e,t,n)=>{const r={type:n.shiftKey?g:n.ctrlKey?S:c,targetUnit:e};t(r)},W=e=>{},f=20,J=(e,t)=>{if(t.newVisibleUnitIds&&t.newVisibleUnitIds.length>0)return{...e,visibleUnitIds:t.newVisibleUnitIds};const n=t.unitsPerPage||e.unitsPerPage||f,r=t.pageNumber||e.page||1;if(n===e.unitsPerPage&&r===e.page)return e;const i=r!==e.page?r:1+Math.floor((e.unitsPerPage||f)*(r-1)/n),d=n*(i-1);return{...e,page:i,unitsPerPage:n,visibleUnitIds:e.orderedUnitIds.slice(d,d+n)}},ee=(e,t)=>({...e,restrictedUnitIds:t.newRestrictedUnitIds,selectedUnitIds:t.newRestrictedUnitIds!==void 0&&e.selectedUnitIds!==void 0?new Set([...e.selectedUnitIds].filter(n=>!t.newRestrictedUnitIds||t.newRestrictedUnitIds.includes(n))):e.selectedUnitIds}),p=(e,t)=>{const n=(e.unitsPerPage||f)*((e.page||1)-1);return e.visibleUnitIds&&e.visibleUnitIds.length>0?t.slice(n,n+(e.unitsPerPage||f)):void 0},te=(e,t)=>{const{newUnitOrder:n}=t,{orderedUnitIds:r}=e;if(!n||n.length===0)throw Error("Attempt to reset unit ordering to empty set.");const i=new Set(r);if(i.size>0&&(n.length!==i.size||n.some(s=>!i.has(s))))throw Error("Reordering units, but the set of units in the new and old ordering don't match.");if(r.every((s,l)=>s===n[l]))return e;const d=p(e,n);return{...e,orderedUnitIds:n,lastClickedId:void 0,visibleUnitIds:d,sortRules:[]}},ne=(e,t)=>{const{sortRules:n}=e,{newSortField:r,sortCallback:i}=t;if(r===void 0||i===void 0)throw Error("Attempt to update sort fields with undefined field or callback.");const d=re(n||[],r,t.ascending),s=i(d),l=p(e,s);return{...e,sortRules:d,orderedUnitIds:s,visibleUnitIds:l,lastClickedId:void 0}},re=(e,t,n)=>{const r=e.pop(),i=n===void 0?(r==null?void 0:r.columnName)===t?!r.sortAscending:!0:n;return r&&r.columnName!==t&&e.push(r),[...e.filter(s=>s.columnName!==t),{columnName:t,sortAscending:i}]},ie="SET_SELECTION",c="UNIQUE_SELECT",L="UNIQUE_SELECT_NEXT",R="UNIQUE_SELECT_PREVIOUS",m="UNIQUE_SELECT_FIRST",v="UNIQUE_SELECT_LAST",S="TOGGLE_UNIT",g="TOGGLE_RANGE",P="TOGGLE_SELECT_ALL",O="DESELECT_ALL",A="INITIALIZE_UNITS",de="SET_UNIT_ORDER",k="UPDATE_SORT_FIELDS",se="SET_VISIBLE_UNITS",oe="SET_RESTRICTED_UNITS",y="COPY_STATE",G={selectedUnitIds:new Set,currentUnitId:void 0,orderedUnitIds:[]},ce=(e,t)=>{const{type:n}=t;switch(n){case A:{const r=new Set(e.orderedUnitIds);if((t.newUnitOrder||[]).filter(i=>!r.has(i)).length===0)return e;if(t.newUnitOrder&&t.newUnitOrder.length>=1)return{...e,orderedUnitIds:h([...new Set([...t.newUnitOrder,...e.orderedUnitIds])])};throw Error("Attempt to initialize table ordering with no actual units passed.")}case ie:return K(e,t);case c:return u(e,t);case L:return q(e);case R:return H(e);case m:return M(e);case v:return $(e);case S:return b(e,t);case g:return e.lastClickedId?B(e,t):b(e,t);case P:return X(e);case O:return{...e,selectedUnitIds:new Set,currentUnitId:void 0};case de:return te(e,t);case k:return ne(e,t);case se:return J(e,t);case oe:return ee(e,t);case y:if(!t.sourceState)throw Error("Attempt to copy state but no source state was provided.");return{...t.sourceState};case"REDISTRIBUTE_UNIT_COLORS":return C(),{...e,orderedUnitIds:[...e.orderedUnitIds],selectedUnitIds:new Set([...e.selectedUnitIds])};default:throw Error(`Invalid mode for unit selection reducer: ${n}`)}},le=()=>a.useContext(x),x=a.createContext({unitSelection:G,unitSelectionDispatch:e=>{}}),Ue=()=>{const{unitSelection:e,unitSelectionDispatch:t}=le(),n=a.useMemo(()=>N(t),[t]),r=a.useMemo(()=>Y(t),[t]),i=a.useMemo(()=>ue(e.orderedUnitIds,e.restrictedUnitIds),[e.orderedUnitIds,e.restrictedUnitIds]);return{selectedUnitIds:e.selectedUnitIds,currentUnitId:e.currentUnitId,orderedUnitIds:i,allOrderedUnitIds:e.orderedUnitIds,visibleUnitIds:e.visibleUnitIds,primarySortRule:e.sortRules&&e.sortRules.length>0?e.sortRules[e.sortRules.length-1]:void 0,page:e.page,unitsPerPage:e.unitsPerPage,checkboxClickHandlerGenerator:n,plotClickHandlerGenerator:r,unitIdSelectionDispatch:t,currentState:e,restrictedUnitIds:e.restrictedUnitIds}},ue=(e,t)=>{if(t===void 0)return e;const n=new Set(t);return e.filter(r=>n.has(r))};exports.COPY_STATE=y;exports.DESELECT_ALL=O;exports.INITIALIZE_UNITS=A;exports.TOGGLE_SELECT_ALL=P;exports.UNIQUE_SELECT_FIRST=m;exports.UNIQUE_SELECT_LAST=v;exports.UNIQUE_SELECT_NEXT=L;exports.UNIQUE_SELECT_PREVIOUS=R;exports.UPDATE_SORT_FIELDS=k;exports.UnitSelectionContext=x;exports.allUnitSelectionState=w;exports.defaultUnitSelection=G;exports.getCheckboxClickHandlerGenerator=N;exports.getUnitColor=z;exports.idToNum=D;exports.redistributeUnitColors=C;exports.sortIds=h;exports.unitSelectionReducer=ce;exports.useSelectedUnitIds=Ue;exports.voidClickHandler=W;
