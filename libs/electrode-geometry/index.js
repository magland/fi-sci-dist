"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const j=require("react/jsx-runtime"),m=require("react"),X=({width:t,height:o,electrodeLocations:s})=>{const[i,c]=m.useState(void 0),n=m.useMemo(()=>{const{xmin:e,xmax:x,ymin:r,ymax:a}=B(s),y=x-e,u=a-r;return Y(y,u,t,o)?s.map(M=>({x:M.y,y:M.x})):s},[s,t,o]),{xmin:l,xmax:P,ymin:d,ymax:g}=m.useMemo(()=>B(n),[n]),C=30,{isotropicScale:f,xPixelOffset:h,yPixelOffset:E,markerPixelRadius:p}=m.useMemo(()=>{let e=0;const x=P-l,r=g-d,a=z(n);for(const y of[1,2]){const u=e+2,v=e+2,M=e+2,S=e+2+C,I=t-u-v,R=o-M-S,A=I/x,D=R/r,T=Math.min(A,D),G=u+(I-x*T)/2,N=M+(R-r*T)/2,U=a*T;if(e=Math.max(1,Math.floor(U/2*.8)),y===2)return{isotropicScale:T,xPixelOffset:G,yPixelOffset:N,markerPixelRadius:e}}throw Error("Unexpected")},[n,t,o,l,P,d,g]),b=m.useMemo(()=>(e,x)=>{const r=h+(e-l)*f,a=E+(x-d)*f;return{xp:r,yp:a}},[h,E,l,d,f]),O=m.useMemo(()=>(e,x)=>{const r=l+(e-h)/f,a=d+(x-E)/f;return{x:r,y:a}},[h,E,l,d,f]),[k,W]=m.useState(void 0);m.useEffect(()=>{if(!k)return;const e=k.getContext("2d");if(!e)return;e.clearRect(0,0,t,o),e.strokeStyle="black",e.lineWidth=1;for(let r=0;r<n.length;r++){const a=n[r],{xp:y,yp:u}=b(a.x,a.y);e.beginPath(),e.arc(y,u,p,0,2*Math.PI),e.stroke(),r===i&&(e.fillStyle="rgba(0, 0, 0, 0.5)",e.fill())}function x(){if(!e)return;const{yp:r}=b(0,g),a=100*f,y=(t-a)/2,u=y,v=y+a,M=r+p+10,S=r+p+10;e.beginPath(),e.moveTo(u,M),e.lineTo(v,S),e.stroke(),e.font="12px sans-serif",e.textAlign="center",e.textBaseline="top",e.fillText("100 Î¼m",(u+v)/2,S+5)}x()},[k,t,o,n,p,i,f,b,g]);const q=m.useCallback(e=>{const{x,y:r}=O(e.nativeEvent.offsetX,e.nativeEvent.offsetY),a=F(n,x,r,p/f/.8);c(a)},[O,n,p,f]),H=m.useCallback(()=>{c(void 0)},[]);return j.jsx("div",{style:{position:"absolute",width:t,height:o},onMouseMove:q,onMouseLeave:H,children:j.jsx("canvas",{ref:e=>e&&W(e),width:t,height:o})})},B=t=>{if(t.length===0)return{xmin:0,xmax:0,ymin:0,ymax:0};let o=t[0].x,s=t[0].x,i=t[0].y,c=t[0].y;for(const n of t)o=Math.min(o,n.x),s=Math.max(s,n.x),i=Math.min(i,n.y),c=Math.max(c,n.y);return{xmin:o,xmax:s,ymin:i,ymax:c}},Y=(t,o,s,i)=>{const c=Math.min(s/t,i/o);return Math.min(s/o,i/t)>c},z=t=>{const o=[];for(let s=0;s<t.length;s++){const i=t[s];let c=1/0;for(let n=0;n<t.length;n++){if(s===n)continue;const l=t[n],P=Math.sqrt(Math.pow(i.x-l.x,2)+Math.pow(i.y-l.y,2));c=Math.min(c,P)}o.push(c)}return o.sort(),o[Math.floor(o.length/2)]},F=(t,o,s,i)=>{for(let c=0;c<t.length;c++){const n=t[c];if(Math.sqrt(Math.pow(n.x-o,2)+Math.pow(n.y-s,2))<=i)return c}};exports.ElectrodeGeometryWidget=X;
