"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const b=require("react/jsx-runtime"),m=require("react"),l=m.createContext({state:{},dispatch:()=>{}}),o=(e,i)=>{switch(i.type){case"report_total_time_range":{const n=e.startTimeSec===void 0?i.startTimeSec:Math.min(e.startTimeSec,i.startTimeSec),c=e.endTimeSec===void 0?i.endTimeSec:Math.max(e.endTimeSec,i.endTimeSec);return{...e,startTimeSec:n,endTimeSec:c}}case"set_visible_time_range":return{...e,visibleStartTimeSec:i.visibleStartTimeSec,visibleEndTimeSec:i.visibleEndTimeSec};case"set_current_time":return{...e,currentTimeSec:i.currentTimeSec};case"set_current_time_fraction":return e.visibleStartTimeSec===void 0||e.visibleEndTimeSec===void 0?e:{...e,currentTimeSec:e.visibleStartTimeSec+i.fraction*(e.visibleEndTimeSec-e.visibleStartTimeSec)};case"pan_time_selection":{if(e.visibleStartTimeSec===void 0||e.visibleEndTimeSec===void 0||e.startTimeSec===void 0||e.endTimeSec===void 0)return e;const n=i.deltaSec;let c=e.visibleStartTimeSec+n,r=e.visibleEndTimeSec+n;return c<e.startTimeSec&&(c=e.startTimeSec,r=c+e.visibleEndTimeSec-e.visibleStartTimeSec),r>e.endTimeSec&&(r=e.endTimeSec,c=r-e.visibleEndTimeSec+e.visibleStartTimeSec),{...e,visibleStartTimeSec:c,visibleEndTimeSec:r}}case"pan_time_selection_pct":{if(e.visibleStartTimeSec===void 0||e.visibleEndTimeSec===void 0||e.startTimeSec===void 0||e.endTimeSec===void 0)return e;const n=i.pct;let c=e.visibleStartTimeSec+n*(e.visibleEndTimeSec-e.visibleStartTimeSec),r=e.visibleEndTimeSec+n*(e.visibleEndTimeSec-e.visibleStartTimeSec);return c<e.startTimeSec&&(c=e.startTimeSec,r=c+e.visibleEndTimeSec-e.visibleStartTimeSec),r>e.endTimeSec&&(r=e.endTimeSec,c=r-e.visibleEndTimeSec+e.visibleStartTimeSec),{...e,visibleStartTimeSec:c,visibleEndTimeSec:r}}case"zoom_time_selection":{if(e.visibleStartTimeSec===void 0||e.visibleEndTimeSec===void 0||e.startTimeSec===void 0||e.endTimeSec===void 0)return e;const n=i.anchorTimeSec||(e.visibleStartTimeSec+e.visibleEndTimeSec)/2,c=i.factor;let r=n+1/c*(e.visibleStartTimeSec-n),t=n+1/c*(e.visibleEndTimeSec-n);return r<e.startTimeSec&&(r=e.startTimeSec),t>e.endTimeSec&&(t=e.endTimeSec),{...e,visibleStartTimeSec:r,visibleEndTimeSec:t}}default:throw Error("Unexpected action type in timeSelectionReducer")}},u=({children:e})=>{const[i,n]=m.useReducer(o,{});return b.jsx(l.Provider,{value:{state:i,dispatch:n},children:e})},_=()=>{const e=m.useContext(l);if(!e)throw Error("useTimeSelection() must be used within a TimeSelectionContextProvider");const i=e.dispatch,n=m.useCallback((S,T)=>{i({type:"report_total_time_range",startTimeSec:S,endTimeSec:T})},[i]),c=m.useCallback((S,T)=>{i({type:"set_visible_time_range",visibleStartTimeSec:S,visibleEndTimeSec:T})},[i]),r=m.useCallback(S=>{i({type:"set_current_time",currentTimeSec:S})},[i]),t=m.useCallback(S=>{i({type:"set_current_time_fraction",fraction:S})},[i]),s=m.useCallback(S=>{i({type:"pan_time_selection",deltaSec:S})},[i]),d=m.useCallback((S,T)=>{i({type:"zoom_time_selection",anchorTimeSec:T,factor:S})},[i]),v=m.useCallback(S=>{i({type:"pan_time_selection_pct",pct:S})},[i]);return{startTimeSec:e.state.startTimeSec,endTimeSec:e.state.endTimeSec,visibleStartTimeSec:e.state.visibleStartTimeSec,visibleEndTimeSec:e.state.visibleEndTimeSec,currentTimeSec:e.state.currentTimeSec,reportTotalTimeRange:n,setVisibleTimeRange:c,setCurrentTime:r,setCurrentTimeFraction:t,zoomTimeSelection:d,panTimeSelection:s,panTimeSelectionPct:v}};exports.SetupTimeSelection=u;exports.TimeSelectionContext=l;exports.timeSelectionReducer=o;exports.useTimeSelection=_;
